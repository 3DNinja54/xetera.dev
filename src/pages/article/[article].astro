---
import { getCollection, getEntryBySlug } from "astro:content";

export const getStaticPaths = async () => {
  const articles = await getCollection("blog");
  return articles.map((article) => {
    return {
      params: { article: article.slug },
      props: { article },
    };
  });
};

type ArticleType = Awaited<ReturnType<typeof getCollection<"blog">>>[number];

let article: ArticleType;

if (Astro.props.article) {
  article = Astro.props.article;
} else if (Astro.params.article) {
  const { article: articleSlug } = Astro.params;
  article = (await getEntryBySlug("blog", articleSlug)) as ArticleType;
} else {
  throw Error("Invalid render condition");
}

const { Content } = await article.render();
---

<Content />
